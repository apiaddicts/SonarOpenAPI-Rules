<h2>Normative - API Definition</h2>
<p>Overriding certain headers or allowing any headers to be set and not specifying required headers can cause some vulnerabilities in the API.</p>
<h2>Noncompliant Code Example (OpenAPI 2)</h2>
<h3>All the examples are in YAML</h3>
<pre>
swagger: "2.0"
info:
  version: 1.0.0
  title: Swagger Petstore
paths:
  /pets:
    get:
      parameters:
        - in: header
          name: Accept
          type: string
          required: true
        - in: header
          name: Authorization
          type: string
          required: true
      responses:
        200:
          description: Ok
</pre>
<h2>Compliant Solution (OpenAPI 2)</h2>
<pre>
swagger: "2.0"
info:
  version: 1.0.0
  title: Swagger Petstore
paths:
  /pets:
    get:
      parameters:
        - in: header
          name: x-api-key
          type: string
          required: true
        - in: header
          name: traceId
          type: string
          required: true
        - in: header
          name: dateTime
          type: string
          required: true
        - in: query
          name: Authorization
          type: string
          required: true
      responses:
        200:
          description: Ok
</pre>
<h2>Noncompliant Code Example (OpenAPI 3)</h2>
<pre>
openapi: "3.0.0"
info:
  version: 1.0.0
  title: Swagger Petstore
components:
  parameters:
    userId:
      in: header
      name: x-user-id
      schema:
        type: string
      required: true
paths:
  /pets:
    get:
      parameters:
      - $ref: '#/components/parameters/userId'
      responses:
        200:
          description: Ok
</pre>
<h2>Compliant Solution (OpenAPI 3)</h2>
<pre>
openapi: "3.0.0"
info:
  version: 1.0.0
  title: Swagger Petstore
paths:
  /pets:
    get:
      parameters:
      - in: header
        name: x-api-key
        schema:
          type: string
        required: true
      - in: header
        name: traceId
        schema:
          type: string
        required: true
      - in: header
        name: dateTime
        schema:
          type: string
        required: true
      responses:
        200:
          description: Ok
</pre>